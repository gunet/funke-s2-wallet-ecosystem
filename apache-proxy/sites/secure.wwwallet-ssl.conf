<VirtualHost *:443>
    ServerName secure.wwwallet

    SSLEngine On
    SSLProxyEngine On

    SSLCertificateFile /etc/apache2/certs/server.cert
    SSLCertificateKeyFile /etc/apache2/certs/server.key

    # Proxy settings
    ProxyPreserveHost On
    ProxyRequests Off

    # WebSocket support for hot-reloading
    RewriteEngine On
    RewriteCond %{HTTP:Upgrade} =websocket [NC]
    RewriteCond %{HTTP:Connection} upgrade [NC]
    RewriteRule /ws(.*) ws://wallet-frontend:3000/$1 [P,L]
    RewriteRule /wss(.*)           ws://wallet-backend-server:8002/$1 [P,L]

		ProxyPass /wallet-backend-server/ http://wallet-backend-server:8002/
    ProxyPassReverse /wallet-backend-server/ http://wallet-backend-server:8002/

		ProxyPass /eID-Client/ http://ausweisapp-client:24727/
    ProxyPassReverse /eID-Client/ http://ausweisapp-client:24727/

    # General HTTP proxy
    ProxyPass / http://wallet-frontend:3000/
    ProxyPassReverse / http://wallet-frontend:3000/



    # Error log configuration
    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>